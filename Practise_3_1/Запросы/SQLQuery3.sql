select top (5) p.partners_id, p.partner_name, sum(pp.products_amount * pr.minimum_cost_for_partner * pt.product_type_coefficient) as total_sales_amount from partners p join partner_products pp on p.partners_id = pp.partners_id join products pr on pp.products_id = pr.products_id join product_type pt on pr.product_type_id = pt.product_type_id group by p.partners_id, p.partner_name order by total_sales_amount desc;
